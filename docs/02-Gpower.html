<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.544">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Julien Martin">
<title>Bio4158 manual - 2&nbsp; Power Analysis with R and G*Power</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./03-reg_lin.html" rel="next">
<link href="./01-introR_4.html" rel="prev">
<link href="./cover.jpg" rel="icon" type="image/jpeg">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="css/style.css">
</head>
<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">BIO4158: manual</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="https://biostats-uottawa.github.io/bio4158_course/"> 
<span class="menu-text">Course</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://biostats-uottawa.github.io/bio4158_course/dataset.html"> 
<span class="menu-text">Data</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-other-resources" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Other resources</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-other-resources">
<li>
    <a class="dropdown-item" href="https://biostats-uottawa.github.io/">
 <span class="dropdown-text">Biostats uOttawa</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://biostats-uottawa.github.io/bio4558_cours/">
 <span class="dropdown-text">Bio4558 (français)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://biostats-uottawa.github.io/bio8940_course/">
 <span class="dropdown-text">Bio8940</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://biostats-uottawa.github.io/intro_r_en.html">
 <span class="dropdown-text">R-way to hell</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://biostats-uottawa.github.io/intro_r_fr.html">
 <span class="dropdown-text">Chemin de l’enf-R</span></a>
  </li>  
    </ul>
</li>
</ul>
</div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools tools-wide">
    <a href="https://github.com/biostats-uottawa/bio4158_course/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item quarto-navbar-tools-item" href="./Bio4158-manual.pdf">
              <i class="bi bi-bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="./Bio4158-manual.epub">
              <i class="bi bi-bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
</div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./02-Gpower.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Power Analysis with R and G\*Power</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-introR_4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-Gpower.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Power Analysis with R and G\*Power</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-reg_lin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Correlation and simple linear regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-t_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Two - sample comparisons</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">One-way ANOVA</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-anova_mult.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Multiway ANOVA: factorial and nested designs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-reg_mult.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Multiple regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-ancova_glm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">ANCOVA and general linear model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Software Tools</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#the-theory" id="toc-the-theory" class="nav-link active" data-scroll-target="#the-theory"><span class="header-section-number">2.1</span> The theory</a>
  <ul class="collapse">
<li><a href="#what-is-power" id="toc-what-is-power" class="nav-link" data-scroll-target="#what-is-power"><span class="header-section-number">2.1.1</span> What is power?</a></li>
  <li><a href="#why-do-a-power-analysis" id="toc-why-do-a-power-analysis" class="nav-link" data-scroll-target="#why-do-a-power-analysis"><span class="header-section-number">2.1.2</span> Why do a power analysis?</a></li>
  <li><a href="#factors-affecting-power" id="toc-factors-affecting-power" class="nav-link" data-scroll-target="#factors-affecting-power"><span class="header-section-number">2.1.3</span> Factors affecting power</a></li>
  </ul>
</li>
  <li><a href="#what-is-gpower" id="toc-what-is-gpower" class="nav-link" data-scroll-target="#what-is-gpower"><span class="header-section-number">2.2</span> What is G*Power?</a></li>
  <li>
<a href="#how-to-use-gpower" id="toc-how-to-use-gpower" class="nav-link" data-scroll-target="#how-to-use-gpower"><span class="header-section-number">2.3</span> How to use G*Power</a>
  <ul class="collapse">
<li><a href="#general-principle" id="toc-general-principle" class="nav-link" data-scroll-target="#general-principle"><span class="header-section-number">2.3.1</span> General Principle</a></li>
  <li><a href="#types-of-power-analyses" id="toc-types-of-power-analyses" class="nav-link" data-scroll-target="#types-of-power-analyses"><span class="header-section-number">2.3.2</span> Types of power analyses</a></li>
  <li><a href="#how-to-calculate-effect-size" id="toc-how-to-calculate-effect-size" class="nav-link" data-scroll-target="#how-to-calculate-effect-size"><span class="header-section-number">2.3.3</span> How to calculate effect size</a></li>
  </ul>
</li>
  <li>
<a href="#power-analysis-for-a-t-test-on-two-independent-means" id="toc-power-analysis-for-a-t-test-on-two-independent-means" class="nav-link" data-scroll-target="#power-analysis-for-a-t-test-on-two-independent-means"><span class="header-section-number">2.4</span> Power analysis for a t-test on two independent means</a>
  <ul class="collapse">
<li><a href="#post-hoc-analysis" id="toc-post-hoc-analysis" class="nav-link" data-scroll-target="#post-hoc-analysis"><span class="header-section-number">2.4.1</span> Post-hoc analysis</a></li>
  <li><a href="#a-priori-analysis" id="toc-a-priori-analysis" class="nav-link" data-scroll-target="#a-priori-analysis"><span class="header-section-number">2.4.2</span> A priori analysis</a></li>
  <li><a href="#sensitivity-analysis---calculate-the-detectable-effect-size" id="toc-sensitivity-analysis---calculate-the-detectable-effect-size" class="nav-link" data-scroll-target="#sensitivity-analysis---calculate-the-detectable-effect-size"><span class="header-section-number">2.4.3</span> Sensitivity analysis - Calculate the detectable effect size</a></li>
  </ul>
</li>
  <li><a href="#important-points-to-remember" id="toc-important-points-to-remember" class="nav-link" data-scroll-target="#important-points-to-remember"><span class="header-section-number">2.5</span> Important points to remember</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/biostats-uottawa/bio4158_course/edit/main/02-Gpower.Rmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/biostats-uottawa/bio4158_course/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Power Analysis with R and G*Power</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><!-- # (PART) Analyse de puissance {.unnumbered}
 --><p>After completing this laboratory, you should :</p>
<ul>
<li>be able to compute the power of a t-test with G*Power and R</li>
<li>be able to calculate the required sample size to achieve a desired power level with a t-test</li>
<li>be able to calculate the detectable effect size by a t-test given the sample size, the power and <span class="math inline">\(\alpha\)</span>
</li>
<li>understand how power changes when sample size increases, the effect size changes, or when <span class="math inline">\(\alpha\)</span> decreases</li>
<li>understand how power is affected when you change from a two-tailed to a one-tailed test.</li>
</ul>
<section id="the-theory" class="level2" data-number="2.1"><h2 data-number="2.1" class="anchored" data-anchor-id="the-theory">
<span class="header-section-number">2.1</span> The theory</h2>
<section id="what-is-power" class="level3" data-number="2.1.1"><h3 data-number="2.1.1" class="anchored" data-anchor-id="what-is-power">
<span class="header-section-number">2.1.1</span> What is power?</h3>
<p><em>Power is the probability of rejecting the null hypothesis when it is false</em></p>
</section><section id="why-do-a-power-analysis" class="level3" data-number="2.1.2"><h3 data-number="2.1.2" class="anchored" data-anchor-id="why-do-a-power-analysis">
<span class="header-section-number">2.1.2</span> Why do a power analysis?</h3>
<section id="assess-the-strength-of-evidence" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="assess-the-strength-of-evidence">Assess the strength of evidence</h4>
<p>Power analysis, performed after accepting a null hypothesis, can help assess the probability of rejecting the null if it were false, and if the magnitude of the effect was equal to that observed (or to any other given magnitude). This type of <em>a posteriori</em> analysis is very common.</p>
</section><section id="design-better-experiments" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="design-better-experiments">Design better experiments</h4>
<p>Power analysis, performed prior to conducting an experiment (but most often after a preliminary experiment), can be used to determine the number of observations required to detect an effect of a given magnitude with some probability (the power). This type of <em>a priori</em> experiment should be more common.</p>
</section><section id="estimate-minimum-detectable-effect" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="estimate-minimum-detectable-effect">Estimate minimum detectable effect</h4>
<p>Sampling effort is often predetermined (when you are handed data of an experiment already completed), or extremely constrained (when logistics dictates what can be done). Whether it is <em>a priori</em> or <em>a posteriori</em>, power analysis can help you estimate, for a fixed sample size and a given power, what is the minimum effect size that can be detected.</p>
</section></section><section id="factors-affecting-power" class="level3" data-number="2.1.3"><h3 data-number="2.1.3" class="anchored" data-anchor-id="factors-affecting-power">
<span class="header-section-number">2.1.3</span> Factors affecting power</h3>
<p>For a given statistical test, there are 3 factors that affect power.</p>
<section id="decision-criteria" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="decision-criteria">Decision criteria</h4>
<p>Power is related to <span class="math inline">\(\alpha\)</span>, the probability level at which one rejects the null hypothesis. If this decision criteria is made very strict (i.e.&nbsp;if critical <span class="math inline">\(\alpha\)</span> is set to a very low value, like 0.1% or <span class="math inline">\(p = 0.001\)</span>), then power will be lower than if the critical <span class="math inline">\(\alpha\)</span> was less strict.</p>
</section><section id="sample-size" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="sample-size">Sample size</h4>
<p>The larger the sample size, the larger the power. As sample size increases, one’s ability to detect small effect sizes as being statistically significant gets better.</p>
</section><section id="effect-size" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="effect-size">Effect size</h4>
<p>The larger the effect size, the larger the power. For a given sample size, the ability to detect an effect as being significant is higher for large effects than for small ones. Effect size measures how false the null hypothesis is.</p>
</section></section></section><section id="what-is-gpower" class="level2" data-number="2.2"><h2 data-number="2.2" class="anchored" data-anchor-id="what-is-gpower">
<span class="header-section-number">2.2</span> What is G*Power?</h2>
<p>G*Power is free software developed by quantitative psychologists from the University of Dusseldorf in Germany. It is available in MacOS and Windows versions. It can be run under Linux using Wine or a virtual machine.</p>
<p>G*Power will allow you to do power analyses for the majority of statistical tests we will cover during the term without making lengthy calculations and looking up long tables and figures of power curves. It is a really useful tool that you need to master.</p>
<p>It is possible to perform all analysis made by G*Power in R, but it requires a bit more code, and a better understanding of the process since everything should be coded by hand. In simple cases, R code is also provided.</p>
<div class="callout callout-style-simple callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Download the software <strong><a href="https://www.psychologie.hhu.de/arbeitsgruppen/allgemeine-psychologie-und-arbeitspsychologie/gpower.html">here</a></strong> and install it on your computer and your workstation (if it is not there already).</p>
</div>
</div>
</section><section id="how-to-use-gpower" class="level2" data-number="2.3"><h2 data-number="2.3" class="anchored" data-anchor-id="how-to-use-gpower">
<span class="header-section-number">2.3</span> How to use G*Power</h2>
<section id="general-principle" class="level3" data-number="2.3.1"><h3 data-number="2.3.1" class="anchored" data-anchor-id="general-principle">
<span class="header-section-number">2.3.1</span> General Principle</h3>
<p>Using G*Power generally involves 3 steps:</p>
<ol type="1">
<li>Choosing the appropriate test</li>
<li>Choosing one of the 5 types of available power analyses</li>
<li>Enter parameter values and press the <strong>Calculate</strong> button</li>
</ol></section><section id="types-of-power-analyses" class="level3" data-number="2.3.2"><h3 data-number="2.3.2" class="anchored" data-anchor-id="types-of-power-analyses">
<span class="header-section-number">2.3.2</span> Types of power analyses</h3>
<p>First, <span class="math inline">\(\alpha\)</span> is define as the probability level at which one rejects the null hypothesis, and <span class="math inline">\(\beta\)</span> is <span class="math inline">\(1 - power\)</span>.</p>
<section id="a-priori" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="a-priori">A priori</h4>
<p>Computes the sample size required given <span class="math inline">\(\beta\)</span>, <span class="math inline">\(\alpha\)</span>, and the effect size. This type of analysis is useful when planning experiments.</p>
</section><section id="compromise" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="compromise">Compromise</h4>
<p>Computes <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> for a given <span class="math inline">\(\alpha\)</span>/<span class="math inline">\(\beta\)</span> ratio, sample size, and effect size. Less commonly used (I have never used it myself) although it can be useful when the <span class="math inline">\(\alpha\)</span>/<span class="math inline">\(\beta\)</span> ratio has meaning, for example when the cost of type I and type II errors can be quantified.</p>
</section><section id="criterion" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="criterion">Criterion</h4>
<p>Computes <span class="math inline">\(\alpha\)</span> for a given <span class="math inline">\(\beta\)</span>, sample size, and effect size. In practice, I see little interest in this. Let me know if you see something I don’t!</p>
</section><section id="post-hoc" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="post-hoc">Post-hoc</h4>
<p>Computes the power for a given <span class="math inline">\(\alpha\)</span>, effect size, and sample size. Used frequently to help in the interpretation of a test that is not statistically significant, but only if an effect size that is biologically significant is used (and not the observed effect size). Not relevant when the test is significant.</p>
</section><section id="sensitivity" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="sensitivity">Sensitivity</h4>
<p>Computes the detectable effect size for a given <span class="math inline">\(\beta\)</span> ,<span class="math inline">\(\alpha\)</span>, and sample size. Very useful at the planning stage of an experiment.</p>
</section></section><section id="how-to-calculate-effect-size" class="level3" data-number="2.3.3"><h3 data-number="2.3.3" class="anchored" data-anchor-id="how-to-calculate-effect-size">
<span class="header-section-number">2.3.3</span> How to calculate effect size</h3>
<p>G*Power can perform power analyses for several statistical tests. The metric for effect size depends on the test. Note that other software packages often use different effect size metrics and that it is important to use the correct one for each package. G<em>Power has an effect size calculator for many tests that only requires you to enter the relevant values. The following table lists the effect size metrics used by G</em>Power for the various tests.</p>
<table class="table">
<colgroup>
<col style="width: 11%">
<col style="width: 38%">
<col style="width: 50%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: center;">Taille d’effet</th>
<th style="text-align: left;">Formule</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">t-test on means</td>
<td style="text-align: center;">d</td>
<td style="text-align: left;"><span class="math inline">\(d = \frac{|\mu_1 - \mu_2|}{\sqrt{({s_1}^2 + {s_2}^2)/2}}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">t-test on correlations</td>
<td style="text-align: center;">r</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">other t-tests</td>
<td style="text-align: center;">d</td>
<td style="text-align: left;"><span class="math inline">\(d = \frac{\mu}{\sigma}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">F-test (ANOVA)</td>
<td style="text-align: center;">f</td>
<td style="text-align: left;"><span class="math inline">\(f = \frac{\frac{\sqrt{\sum_{i=1}^k (\mu_i - \mu)^2}}{k}}{\sigma}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">other F-tests</td>
<td style="text-align: center;"><span class="math inline">\(f^2\)</span></td>
<td style="text-align: left;"><span class="math inline">\(f^2 = \frac{{R_p}^2}{1-{R_p}^2}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: center;"></td>
<td style="text-align: left;">
<span class="math inline">\({R_p}\)</span> is the squared partial correlation coefficient</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Chi-square test</td>
<td style="text-align: center;">w</td>
<td style="text-align: left;"><span class="math inline">\(w = \sqrt{ \sum_{i=1}^m \frac{(p_{0i} - p_{1i})^2 }{ p_{0i}} }\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: center;"></td>
<td style="text-align: left;">
<span class="math inline">\(p_{0i}\)</span> and <span class="math inline">\(p_{1i}\)</span> are theporportion in category <span class="math inline">\(i\)</span> predicted by the null, <span class="math inline">\(_0\)</span>, and alternative, <span class="math inline">\(_1\)</span>, hypothesis</td>
</tr>
</tbody>
</table></section></section><section id="power-analysis-for-a-t-test-on-two-independent-means" class="level2" data-number="2.4"><h2 data-number="2.4" class="anchored" data-anchor-id="power-analysis-for-a-t-test-on-two-independent-means">
<span class="header-section-number">2.4</span> Power analysis for a t-test on two independent means</h2>
<div class="callout callout-style-simple callout-important">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>All the power analysis presented in this chapter can be done using 2 functions in R.</p>
<ul>
<li>
<code><a href="https://rdrr.io/pkg/pwr/man/pwr.t.test.html">pwr.t.test()</a></code> when the two samples have a similar size</li>
<li>
<code><a href="https://rdrr.io/pkg/pwr/man/pwr.t2n.test.html">pwr.t2n.test()</a></code> when samples have different numbers of observations</li>
</ul>
</div>
</div>
</div>
<p>The objective of this lab is to learn to use G*Power and understand how the 4 parameters of power analyses (<span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span>, sample size and effect size) are related to each other. For this, you will only use the standard t-test to compare two independent means. This is the test most used by biologists, you have all used it, and it will serve admirably for this lab. What you will learn today will be applicable to all other power analyses.</p>
<p>Jaynie Stephenson studied the productivity of streams in the Ottawa region. She has measured fish biomass in 36 streams, 18 on the Shield and 18 in the Ottawa Valley. She found that fish biomass was lower in streams from the valley (2.64 <span class="math inline">\(g/m^2\)</span> , standard deviation = 3.28) than from the Shield (3.31 <span class="math inline">\(g/m^2\)</span> , standard deviation = 2.79.).</p>
<p>When she tested the null hypothesis that fish biomass is the same in the two regions by a t-test, she obtained:</p>
<pre><code>Pooled-Variance Two-Sample t-Test
t = -0.5746, df = 34, p-value = 0.5693</code></pre>
<p>She therefore accepted the null hypothesis (since p is much larger than 0.05) and concluded that fish biomass is the same in the two regions.</p>
<section id="post-hoc-analysis" class="level3" data-number="2.4.1"><h3 data-number="2.4.1" class="anchored" data-anchor-id="post-hoc-analysis">
<span class="header-section-number">2.4.1</span> Post-hoc analysis</h3>
<p>Using the observed means and standard deviations, we can use G*Power to calculate the power of the two-tailed t-test for two independent means, using the observed effect size (the difference between the two means, weighted by the standard deviations) for <span class="math inline">\(\alpha\)</span> = 0.05.</p>
<p>Start G*Power.</p>
<ol type="1">
<li>In *<strong>Test family</strong> , choose: t tests</li>
<li>For <strong>Statistical test</strong> , choose: Means: Difference between two independent means (two groups)</li>
<li>For <strong>Type of power analysis</strong> , choose: Post hoc: Compute achieved power - given <span class="math inline">\(\alpha\)</span>, sample size, and effect size</li>
<li>At <strong>Input Parameters</strong> ,</li>
</ol>
<ul>
<li>in the box <strong>Tail(s)</strong> , chose: Two,</li>
<li>check that <span class="math inline">\(\alpha\)</span> <strong>err prob</strong> is equal to 0.05</li>
<li>Enter 18 for the <strong>Sample size</strong> of group 1 and of group 2</li>
<li>then, to calculate effect size (d), click on <strong>Determine =&gt;</strong>
</li>
</ul>
<ol start="5" type="1">
<li>In the window that opens,</li>
</ol>
<ul>
<li>select <strong>n1 = n2</strong> , then</li>
<li>enter the two means (<strong>Mean group</strong> 1 et 2)</li>
<li>the two standard deviations(<strong>SD group</strong> 1 et 2)</li>
<li>click on <strong>Calculate</strong> and <strong>transfer to main window</strong>
</li>
</ul>
<ol start="6" type="1">
<li>After you click on the <strong>Calculate button</strong> in the main window, you should get the following:</li>
</ol>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/gpower_1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Post-hoc analysis with estimated effect size</figcaption></figure>
</div>
</div>
</div>
<p>Similar analysis can be done in R. You first need to calculate the effect size <code>d</code> for a t-test comparing 2 means, and then use the <code><a href="https://rdrr.io/pkg/pwr/man/pwr.t.test.html">pwr.t.test()</a></code> function from the <code>pwr</code> 📦. The easiest is to create anew function in R to estimate the effect size <code>d</code>since we are going to reuse it multiple times during the lab.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># load package pwr</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/heliosdrm/pwr">pwr</a></span><span class="op">)</span></span>
<span><span class="co"># define d for a 2 sample t-test</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">u1</span>, <span class="va">u2</span>, <span class="va">sd1</span>, <span class="va">sd2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">u1</span> <span class="op">-</span> <span class="va">u2</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">sd1</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">sd2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># power analysis</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pwr/man/pwr.t.test.html">pwr.t.test</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">18</span>,</span>
<span>  d <span class="op">=</span> <span class="fu">d</span><span class="op">(</span>u1 <span class="op">=</span> <span class="fl">2.64</span>, sd1 <span class="op">=</span> <span class="fl">3.28</span>, u2 <span class="op">=</span> <span class="fl">3.31</span>, sd2 <span class="op">=</span> <span class="fl">2.79</span><span class="op">)</span>,</span>
<span>  sig.level <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"two.sample"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Two-sample t test power calculation 

              n = 18
              d = 0.220042
      sig.level = 0.05
          power = 0.09833902
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
</div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># plot similar to G*Power</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span>, length <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">qc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">16</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">qc</span>, col <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="op">-</span><span class="va">qc</span>, col <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, mean <span class="op">=</span> <span class="op">(</span><span class="fl">3.31</span> <span class="op">-</span> <span class="fl">2.64</span><span class="op">)</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="st">"blue"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># power corresponds to the shaded area</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, mean <span class="op">=</span> <span class="op">(</span><span class="fl">3.31</span> <span class="op">-</span> <span class="fl">2.64</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html">polygon</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">x</span> <span class="op">&lt;=</span> <span class="op">-</span><span class="va">qc</span><span class="op">]</span>, <span class="op">-</span><span class="va">qc</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">y</span><span class="op">[</span><span class="va">x</span> <span class="op">&lt;=</span> <span class="op">-</span><span class="va">qc</span><span class="op">]</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span>red <span class="op">=</span> <span class="fl">0</span>, green <span class="op">=</span> <span class="fl">0.2</span>, blue <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02-Gpower_files/figure-html/r-power-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Post-hoc analysis with estimated effect size in R</figcaption></figure>
</div>
</div>
</div>
<p>Let’s examine the figure @ref(fig:gpower-1).</p>
<ul>
<li>The curve on the left, in red, corresponds to the expected distribution of the t-statistics when <span class="math inline">\(H_0\)</span> is true (<em>i.e.</em> when the two means are equal) given the sample size (18 per region) and the observed standard deviations.</li>
<li>The vertical green lines correspond to the critical values of t for <span class="math inline">\(\alpha = 0.05\)</span> and a total sample size of 36 (2x18).</li>
<li>The shaded pink regions correspond to the rejection zones for <span class="math inline">\(H_0\)</span>. If Jaynie had obtained a <em>t-value</em> outside the interval delimited by the critical values ranging from -2.03224 to 2.03224, she would then have rejected <span class="math inline">\(H_0\)</span> , the null hypothesis of equal means. In fact, she obtained a t-value of -0.5746 and concluded that the biomass is equal in the two regions.</li>
<li>The curve on the right, in blue, corresponds to the expected distribution of the t-statistics if <span class="math inline">\(H_1\)</span> is true (here <span class="math inline">\(H_1\)</span> is that there is a difference in biomass between the two regions equal to <span class="math inline">\(3.33 - 2.64 = 0.69 g/m^2\)</span> , given the observed standard deviations). This distribution is what we should observe if <span class="math inline">\(H_1\)</span> was true and we repeated a large number of times the experiment using random samples of 18 streams in each of the two regions and calculated a t-statistic for each sample. On average, we would obtain a t-statistic of about 0.6.</li>
<li>Note that there is considerable overlap of the two distributions and that a large fraction of the surface under the right curve is within the interval where <span class="math inline">\(H_0\)</span> is accepted between the two vertical green lines at -2.03224 and 2.03224. This proportion, shaded in blue under the distribution on the right is labeled <span class="math inline">\(\beta\)</span> and corresponds to the risk of <em>type II error</em> (accept <span class="math inline">\(H_0\)</span> when <span class="math inline">\(H_1\)</span> is true).</li>
<li>Power is simply <span class="math inline">\(1-\beta\)</span>, and is here 0.098339. Therefore, if the mean biomass differed by <span class="math inline">\(0.69 g/m^2\)</span> between the two regions, Jaynie had only 9.8% chance of being able to detect it as a statistically significant difference at =5% with a sample size of 18 streams in each region.</li>
</ul>
<p><strong>Let’s recapitulate</strong>: The difference in biomass between regions is not statistically significant according to the t-test. It is because the difference is relatively small relative to the precision of the measurements. It is therefore not surprising that that power, i.e.&nbsp;the probability of detecting a statistically significant difference, is small. Therefore, this analysis is not very informative.</p>
<p><strong>Indeed, a post hoc power analysis using the observed effect size is not useful</strong>. It is much more informative to conduct a post hoc power analysis for an effect size that is different from the observed effect size. But what effect size to use? It is the biology of the system under study that will guide you. For example, with respect to fish biomass in streams, one could argue that a two fold change in biomass (say from 2.64 to 5.28 g/m<sup>2</sup> ) has ecologically significant repercussions. We would therefore want to know if Jaynie had a good chance of detecting a difference as large as this before accepting her conclusion that the biomass is the same in the two regions. So, what were the odds that Jaynie could detect a difference of 2.64 g/m<sup>2</sup> between the two regions? G*Power can tell you if you cajole it the right way.</p>
<div class="callout callout-style-simple callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Change the mean of group 2 to 5.28, recalculate effect size, and click on Calculate to obtain figure @ref(fig:gpower-2).</p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/gpower_2.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Post-hoc analysis using an effect size different from the one estimated</figcaption></figure>
</div>
</div>
</div>
<p>Same analysis using R (without all the code for the interesting but not really useful plot)</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pwr/man/pwr.t.test.html">pwr.t.test</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">18</span>,</span>
<span>  d <span class="op">=</span> <span class="fu">d</span><span class="op">(</span>u1 <span class="op">=</span> <span class="fl">2.64</span>, sd1 <span class="op">=</span> <span class="fl">3.28</span>, u2 <span class="op">=</span> <span class="fl">5.28</span>, sd2 <span class="op">=</span> <span class="fl">2.79</span><span class="op">)</span>,</span>
<span>  sig.level <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"two.sample"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Two-sample t test power calculation 

              n = 18
              d = 0.8670313
      sig.level = 0.05
          power = 0.7146763
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
</div>
</div>
<p>The power is 0.71, therefore Jaynie had a reasonable chance (71%) of detecting a doubling of biomass with 18 streams in each region.</p>
<p>Note that this post hoc power analysis, done for an effect size considered biologically meaningful, is much more informative than the preceeding one done with the observed effect size (which is what too many students do because it is the default of so many power calculation programs). Jaynie did not detect a difference between the two regions. There are two possibilities: 1) there is really no difference between the regions, or 2) the precision of measurements is so low (because the sample size is small and/or there is large variability within a region) that it is very unlikely to be able to detect even large differences. The second power analysis can eliminate this second possibility because Jaynie had 71% chances of detecting a doubling of biomass.</p>
</section><section id="a-priori-analysis" class="level3" data-number="2.4.2"><h3 data-number="2.4.2" class="anchored" data-anchor-id="a-priori-analysis">
<span class="header-section-number">2.4.2</span> A priori analysis</h3>
<p>Suppose that a difference in biomass of <span class="math inline">\(3.31-2.64 = 0.67 g/m^2\)</span> can be ecologically significant. The next field season should be planned so that Jaynie would have a good chance of detecting such a difference in fish biomass between regions. How many streams should Jaynie sample in each region to have 80% of detecting such a difference (given the observed variability)?</p>
<div class="callout callout-style-simple callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Change the type of power analysis in G*Power to <strong>A priori: Compute sample size - given <span class="math inline">\(\alpha\)</span> , power, and effect size</strong>. Ensure that the values for means and standard deviations are those obtained by Jaynie. Recalculate the effect size metric and enter 0.8 for power and you will obtain (@ref(fig:gpower-3).</p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/gpower_3.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>A priori analysis</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pwr/man/pwr.t.test.html">pwr.t.test</a></span><span class="op">(</span></span>
<span>  power <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  d <span class="op">=</span> <span class="fu">d</span><span class="op">(</span>u1 <span class="op">=</span> <span class="fl">2.64</span>, sd1 <span class="op">=</span> <span class="fl">3.28</span>, u2 <span class="op">=</span> <span class="fl">3.31</span>, sd2 <span class="op">=</span> <span class="fl">2.79</span><span class="op">)</span>,</span>
<span>  sig.level <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"two.sample"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Two-sample t test power calculation 

              n = 325.1723
              d = 0.220042
      sig.level = 0.05
          power = 0.8
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
</div>
</div>
<p><strong>Ouch!</strong> The required sample would be of 326 streams in each region! It would cost a fortune and require several field teams otherwise only a few dozen streams could be sampled over the summer and it would be very unlikely that such a small difference in biomass could be detected. Sampling fewer streams would probably be in vain and could be considered as a waste of effort and time: why do the work on several dozens of streams if the odds of success are that low?</p>
<p>If we recalculate for a power of 95%, we find that 538 streams would be required from each region. Increasing power means more work!</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pwr/man/pwr.t.test.html">pwr.t.test</a></span><span class="op">(</span></span>
<span>  power <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  d <span class="op">=</span> <span class="fu">d</span><span class="op">(</span>u1 <span class="op">=</span> <span class="fl">2.64</span>, sd1 <span class="op">=</span> <span class="fl">3.28</span>, u2 <span class="op">=</span> <span class="fl">3.31</span>, sd2 <span class="op">=</span> <span class="fl">2.79</span><span class="op">)</span>,</span>
<span>  sig.level <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"two.sample"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Two-sample t test power calculation 

              n = 537.7286
              d = 0.220042
      sig.level = 0.05
          power = 0.95
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
</div>
</div>
</section><section id="sensitivity-analysis---calculate-the-detectable-effect-size" class="level3" data-number="2.4.3"><h3 data-number="2.4.3" class="anchored" data-anchor-id="sensitivity-analysis---calculate-the-detectable-effect-size">
<span class="header-section-number">2.4.3</span> Sensitivity analysis - Calculate the detectable effect size</h3>
<p>Given the observed variability, a sampling effort of 18 streams per region, and with <span class="math inline">\(\alpha\)</span> = 0.05, what effect size could Jaynie detect with 80% probability <span class="math inline">\(\beta=0.2\)</span>)?</p>
<div class="callout callout-style-simple callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Change analysis type in G*Power to <strong>Sensitivity: Compute required effect size - given <span class="math inline">\(\alpha\)</span> , power, and sample size</strong> and size is 18 in each region.</p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/gpower_4.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Analyse de sensitivité</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pwr/man/pwr.t.test.html">pwr.t.test</a></span><span class="op">(</span></span>
<span>  power <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">18</span>,</span>
<span>  sig.level <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"two.sample"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Two-sample t test power calculation 

              n = 18
              d = 0.9612854
      sig.level = 0.05
          power = 0.8
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
</div>
</div>
<p>The detectable effect size for this sample size, <span class="math inline">\(\alpha = 0.05\)</span> and <span class="math inline">\(\beta = 0.2\)</span> (or power of 80%) is 0.961296.</p>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Attention, this effect size is the metric <code>d</code> and is dependent on sampling variability.</p>
</div>
</div>
</div>
<p>Here, <code>d</code> is approximately equal to</p>
<p><span class="math display">\[ d = \frac{| \bar{X_1} \bar{X_2} |} {\sqrt{\frac{{s_1}^2 +{s_2}^2}{2}}}\]</span></p>
<p>To convert this d value without units into a value for the detectable difference in biomass between the two regions, you need to multiply <code>d</code> by the denominator of the equation.</p>
<p><span class="math display">\[
| \bar{X_1} - \bar{X_2} | = d * \sqrt{\frac{{s_1}^2 +{s_2}^2}{2}}
\]</span></p>
<p>In R this can be done with the following code</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pwr/man/pwr.t.test.html">pwr.t.test</a></span><span class="op">(</span></span>
<span>  power <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">18</span>,</span>
<span>  sig.level <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"two.sample"</span><span class="op">)</span><span class="op">$</span><span class="va">d</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="fl">3.28</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">2.79</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.926992</code></pre>
</div>
</div>
<p>Therefore, with 18 streams per region, <span class="math inline">\(\alpha\)</span> = 0.05 and <span class="math inline">\(\beta\)</span> = 0.2 (so power of 80%), Jaynie could detect a difference of 2.93 g/m<sup>2</sup> between regions, a bit more than a doubling of biomass.</p>
</section></section><section id="important-points-to-remember" class="level2" data-number="2.5"><h2 data-number="2.5" class="anchored" data-anchor-id="important-points-to-remember">
<span class="header-section-number">2.5</span> Important points to remember</h2>
<ul>
<li>Post hoc power analyses are relevant only when the null hypothesis is accepted because it is impossible to make a <em>type II error</em> when rejecting <span class="math inline">\(H_0\)</span> .</li>
<li>With very large samples, power is very high and minute differences can be statistically detected, even if they are not biologically significant.</li>
<li>When using a stricter significance criteria (<span class="math inline">\(\alpha &lt; 0.05\)</span>) power is reduced.</li>
<li>Maximizing power implies more sampling effort, unless you use a more liberal statistical criteria (<span class="math inline">\(\alpha &gt; 0.05\)</span>)</li>
<li>The choice of <span class="math inline">\(\beta\)</span> is somewhat arbitrary. <span class="math inline">\(\beta=0.2\)</span> (power of 80%) is considered relatively high by most.</li>
</ul>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./01-introR_4.html" class="pagination-link  aria-label=" to="" r="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to R</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./03-reg_lin.html" class="pagination-link" aria-label="<span class='chapter-number'>3</span>&nbsp; <span class='chapter-title'>Correlation and simple linear regression</span>">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Correlation and simple linear regression</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Written by Julien Martin.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/biostats-uottawa/bio4158_course/edit/main/02-Gpower.Rmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/biostats-uottawa/bio4158_course/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>


</body></html>